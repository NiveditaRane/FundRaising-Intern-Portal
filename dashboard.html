<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Intern Dashboard</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  
  <div class="hero-overlay">
    <div class="hero-header">
      <h1 class="brand-title">She Can Foundation</h1>
    </div>

    <div class="hero-content">
      <div class="dashboard-box">
        <h2>Welcome, <span id="name">Loading...</span></h2>
        <p>Referral Code: <strong id="referral"></strong></p>
        <p>Total Donations: â‚¹<strong id="donation"></strong></p>
        <a href="leaderboard.html" class="btn">View Leaderboard</a>
        <h3 style="margin-top: 30px;">Rewards</h3>
        <ul>
          <li class="reward_1">Stickers</li>
          <li class="reward_2">Book</li>
          <li class="reward_3">Sipper</li>
        </ul>
        <div class="logout">
          <a href="index.html">Logout</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    const nameFromUrl = getQueryParam("name");
    const referralFromUrl = nameFromUrl ? nameFromUrl.toLowerCase() + "2025" : null;

    if (referralFromUrl) {
      fetch(`https://fundraising-intern-portal-backend.onrender.com/api/intern?referral=${encodeURIComponent(referralFromUrl)}`)
        .then(response => {
          if (!response.ok) throw new Error("Intern not found");
          return response.json();
        })
        .then(data => {
          document.getElementById("name").textContent = data.name;
          document.getElementById("referral").textContent = data.referral;
          document.getElementById("donation").textContent = data.donation;
        })
        .catch(error => {
          console.error(error);
          document.getElementById("name").textContent = nameFromUrl || "Guest";
          document.getElementById("referral").textContent = referralFromUrl || "";
          document.getElementById("donation").textContent = "0";
        });
    }
  </script>

</body>
</html>
